#+STARTUP: showall

#+TITLE:     3. Modelling Action Potentials
#+AUTHOR:    Paul Gribble & Dinant Kistemaker
#+EMAIL:     paul@gribblelab.org
#+DATE:      fall 2012
#+LINK_UP: http://www.gribblelab.org/compneuro/2_Modelling_Dynamical_Systems.html
#+LINK_HOME: http://www.gribblelab.org/compneuro/index.html
#+BIBLIOGRAPHY: refs plain option:-d limit:t

-----
[TABLE-OF-CONTENTS]
-----

* Introduction

In this section we will use a model of voltage-gated ion channels in a
single neuron to simulate action potentials. The model is based on the
work by Hodgkin & Huxley in the 1940s and 1950s
\cite{HH1952,HH1990}. A good reference to refresh your memory about
how ion channels in a neuron work is the Kandel, Schwartz & Jessel
book "Principles of Neural Science".

To model the action potential we will use an article by Ekeberg et              
al. (1991) published in Biological Cybernetics
\cite{ekeberg1991}. When reading the article you can focus on the
first three pages (up to paragraph 2.3) and try to find answers to the
following questions:

- How many differential equations are there?
- What is the order of the system described in equations 1-9?
- What are the states and state derivatives of the system?

* Simulating the Hodgkin & Huxley model

Before we begin coding up the model, it may be useful to remind you of
a fundamental law of electricity, one that relates electrical
potential $V$ to electric current $I$ and resistance $R$ (or
conductance $G$, the reciprocal of resistance). This of course is
known as [[http://en.wikipedia.org/wiki/Ohm's_law][Ohm's law]]:

\begin{equation}
V = IR
\end{equation}

or 

\begin{equation}
V = \frac{I}{G}
\end{equation}

Our goal here is to code up a dynamical model of the membrane's
electric circuit including two types of ion channels: sodium and
potassium channels. We will use this model to better understand the
process underlying the origin of an action potential.

** Step 1: membrane potential

Equation (1) of Ekeberg is a differential equation describing the
relation between the time derivative of the membrane potential $E$ as
a function of the passive leak current through the membrane, and the
current through the ion channels. Note that Ekeberg uses $E$ instead
of the typical $V$ symbol to represent electrical potential.

\begin{equation}
\frac{dE}{dt} = \frac{(E_{leak}-E)G_{m} + \sum{\left(E_{comp}-E\right)}G_{core} + I_{channels}}{C_{m}}
\end{equation}

Don't panic, it's not actually that complicated. What this equation is
saying is that the rate of change of electrical potential across the
current (the left hand side of the equation, $\frac{dE}{dt}$) is equal
to the sum of a bunch of other terms, divided by membrane capacitance
$C_{m}$ (the right hand side of the equation). Recall from basic
physics that [[http://en.wikipedia.org/wiki/Capacitance][capacitance]] is a measure of the ability of something to
store an electrical charge.

The "bunch of other things" includes (in order of appearance) a
passive leakage current, a term characterizing the electrical coupling
of different compartments, and the currents entering through all of
the active ion channels into the compartment.

x

[[file:code/ekeberg.py][ekeberg.py]]

#+ATTR_HTML: width="600px" align="center"
#+CAPTION: Spiking neuron simulation based on Ekeberg et al., 1991
[[file:figs/ekeberg1.png]]



* Next steps

x

[ next ]
